# AI PPT Restorer | AIç”ŸæˆPPTå›¾ç‰‡è¿˜åŸå·¥å…·

<div align="center">

![Python Version](https://img.shields.io/badge/python-3.8+-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)
![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20Linux%20%7C%20macOS-lightgrey.svg)

**å°†AIç”Ÿæˆçš„ç²¾ç¾PPTå›¾ç‰‡è¿˜åŸä¸ºå¯ç¼–è¾‘çš„PPTæ–‡æ¡£**

[English](#english) | [ä¸­æ–‡æ–‡æ¡£](#chinese)

</div>

---

<a name="chinese"></a>

## ğŸ“– é¡¹ç›®ç®€ä»‹

ä½¿ç”¨Google Nano Banana Proç­‰AIå·¥å…·ç”Ÿæˆçš„PPTè™½ç„¶è§†è§‰æ•ˆæœæƒŠè‰³ï¼Œä½†è¾“å‡ºçš„æ˜¯**ä¸å¯ç¼–è¾‘çš„å›¾ç‰‡æ ¼å¼**ã€‚å½“éœ€è¦ä¿®æ”¹æ–‡å­—å†…å®¹æ—¶ï¼Œåªèƒ½é‡æ–°ç”Ÿæˆï¼Œæå…¶ä¸ä¾¿ã€‚
å‚è€ƒè§†é¢‘ï¼š
https://www.bilibili.com/video/BV1a7mJBbEht/?vd_source=32d1e5983d8d2a40a44db0d2e38f9ab4

**AI PPT Restorer** æ˜¯ä¸€ä¸ªå¼€æºå·¥å…·ï¼Œé€šè¿‡ **OCRæ–‡å­—è¯†åˆ« + AIæ™ºèƒ½ä¿®å¤** æŠ€æœ¯ï¼Œå°†AIç”Ÿæˆçš„PPTå›¾ç‰‡è¿˜åŸä¸ºå®Œå…¨å¯ç¼–è¾‘çš„PPTæ–‡æ¡£ï¼Œå®ç°ï¼š

âœ… è‡ªåŠ¨è¯†åˆ«å›¾ç‰‡ä¸­çš„æ–‡å­—ä½ç½®å’Œå†…å®¹
âœ… AIæ™ºèƒ½å»é™¤æ–‡å­—åŒºåŸŸï¼Œç”Ÿæˆå¹²å‡€èƒŒæ™¯
âœ… è¿˜åŸä¸ºå¯ç¼–è¾‘çš„æ–‡æœ¬æ¡†å›¾å±‚
âœ… æ”¯æŒæ‰‹åŠ¨æ¶‚æŠ¹è¡¥å……å’Œè¿­ä»£ä¿®å¤
âœ… å…¨å±€æ’¤é”€/é‡åšï¼Œæ“ä½œé›¶é£é™©

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1ï¸âƒ£ OCRæ™ºèƒ½è¯†åˆ«
- åŸºäºPaddleOCRè‡ªåŠ¨æ£€æµ‹æ–‡å­—ä½ç½®
- è¯†åˆ«æ–‡å­—å†…å®¹å’Œå­—ä½“å¤§å°
- æ”¯æŒå•é¡µå’Œæ‰¹é‡å¤„ç†
- æ”¯æŒGPUåŠ é€Ÿï¼ˆé€Ÿåº¦æå‡5-10å€ï¼‰

### 2ï¸âƒ£ AIèƒŒæ™¯ç”Ÿæˆ
- é›†æˆIOPaint APIæ™ºèƒ½ä¿®å¤
- è‡ªåŠ¨å»é™¤æ–‡å­—åŒºåŸŸ
- ç”Ÿæˆæ— ç—•å¹²å‡€èƒŒæ™¯
- æ”¯æŒæœ¬åœ°/äº‘ç«¯APIéƒ¨ç½²

### 3ï¸âƒ£ è‡ªå®šä¹‰æ¶‚æŠ¹å·¥å…·
- ğŸ–Œï¸ ç¬”åˆ·å·¥å…·ï¼šæ¶‚æŠ¹å¼æ ‡è®°
- â¬œ æ¡†é€‰å·¥å…·ï¼šçŸ©å½¢æ¡†é€‰
- å¯è°ƒèŠ‚ç¬”åˆ·å¤§å°ï¼ˆ5-100pxï¼‰
- å®æ—¶è§†è§‰åé¦ˆ

### 4ï¸âƒ£ è¿­ä»£ä¿®å¤æ¨¡å¼ â­
- åœ¨å·²ç”Ÿæˆçš„èƒŒæ™¯ä¸Šç»§ç»­ç¼–è¾‘
- æ™ºèƒ½æ£€æµ‹èƒŒæ™¯å›¾è‡ªåŠ¨åˆ‡æ¢æ¨¡å¼
- å¤šæ¬¡è¿­ä»£ç›´åˆ°å®Œç¾

### 5ï¸âƒ£ å…¨å±€æ’¤é”€/é‡åš â­
- æ”¯æŒæ–‡æœ¬æ¡†ç¼–è¾‘æ’¤é”€
- æ”¯æŒæ¶‚æŠ¹æ“ä½œæ’¤é”€
- æ”¯æŒèƒŒæ™¯ç”Ÿæˆæ’¤é”€
- å¯æ’¤é”€åˆ°åŸå›¾çŠ¶æ€
- å¿«æ·é”®ï¼š`Ctrl+Z` / `Ctrl+Y`
- æœ€å¤š50æ­¥å†å²è®°å½•

### 6ï¸âƒ£ å®Œæ•´ç¼–è¾‘åŠŸèƒ½
- æ–‡æœ¬æ¡†æ‹–æ‹½ã€ç¼©æ”¾ã€æ—‹è½¬
- å­—ä½“ã€å­—å·ã€é¢œè‰²è°ƒæ•´
- å¯¹é½å’Œåˆ†å¸ƒå·¥å…·
- æ‰¹é‡æ“ä½œå’Œå¤åˆ¶ç²˜è´´

### 7ï¸âƒ£ å¤šæ ¼å¼æ”¯æŒ
- å¯¼å…¥ï¼šPNGã€JPGã€PDF
- å¯¼å‡ºï¼šPPTXã€PDF

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- Windows / Linux / macOS
- IOPaintæœåŠ¡ï¼ˆç”¨äºAIèƒŒæ™¯ç”Ÿæˆï¼‰

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/Tansuo2021/OCRPDF-TO-PPT.git
cd OCRPDF-TO-PPT
```

#### 2. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

ä¾èµ–åŒ…æ‹¬ï¼š
- `python-pptx` - PPTç”Ÿæˆ
- `Pillow` - å›¾åƒå¤„ç†
- `opencv-python` - å›¾åƒæ“ä½œ
- `numpy` - æ•°å€¼è®¡ç®—
- `paddleocr` - OCRè¯†åˆ«
- `paddlepaddle` - æ·±åº¦å­¦ä¹ æ¡†æ¶
- `requests` - APIè°ƒç”¨
- `PyMuPDF` - PDFå¤„ç†

#### 3. å®‰è£…å¹¶å¯åŠ¨IOPaintæœåŠ¡ å‚è€ƒå¦‚ä¸‹

https://www.iopaint.com/install/windows_1click_installer

> ğŸ’¡ **æç¤º**ï¼šIOPaintæ”¯æŒCPUå’ŒGPUæ¨¡å¼ï¼ŒGPUå¯å¤§å¹…æå‡å¤„ç†é€Ÿåº¦

#### 4. è¿è¡Œç¨‹åº

```bash
python modern_ppt_editor_full_enhanced.py
```

---

## ğŸ“š ä½¿ç”¨æ•™ç¨‹

### æ–¹å¼ä¸€ï¼šOCRè‡ªåŠ¨è¯†åˆ« + èƒŒæ™¯ç”Ÿæˆ

**é€‚ç”¨åœºæ™¯**ï¼šæ ‡å‡†æ–‡æ¡£ã€æ–‡å­—æ¸…æ™°çš„PPTå›¾ç‰‡

```
1. ç‚¹å‡»"å¯¼å…¥å›¾ç‰‡"æˆ–"å¯¼å…¥PDF"
2. ç‚¹å‡»"æ£€æµ‹ - å½“å‰é¡µ"ï¼ˆOCRè‡ªåŠ¨è¯†åˆ«ï¼‰
3. ç‚¹å‡»"èƒŒæ™¯ç”Ÿæˆ - å½“å‰é¡µ"
4. ç­‰å¾…5-30ç§’
5. åˆ‡æ¢åˆ°"PPTæ•ˆæœ"æŸ¥çœ‹ç»“æœ
6. ç¼–è¾‘æ–‡æœ¬æ¡†å†…å®¹ã€ä½ç½®ã€æ ·å¼
7. ç‚¹å‡»"ç”ŸæˆPPT"å¯¼å‡º
```

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨æ¶‚æŠ¹ + èƒŒæ™¯ç”Ÿæˆ

**é€‚ç”¨åœºæ™¯**ï¼šæ°´å°å»é™¤ã€Logoå»é™¤ã€OCRè¯†åˆ«ä¸å…¨

```
1. å¯¼å…¥å›¾ç‰‡
2. ç‚¹å‡»"è¿›å…¥æ¶‚æŠ¹"
3. é€‰æ‹©å·¥å…·ï¼š
   - âœï¸ ç¬”åˆ·ï¼šæ¶‚æŠ¹ä¸è§„åˆ™åŒºåŸŸ
   - â¬œ æ¡†é€‰ï¼šæ¡†é€‰çŸ©å½¢åŒºåŸŸ
4. æ ‡è®°éœ€è¦å»é™¤çš„åŒºåŸŸ
5. ç‚¹å‡»"ğŸ¨ç”ŸæˆèƒŒæ™¯"
6. ç­‰å¾…å®Œæˆ
7. ç¼–è¾‘æ–‡æœ¬æ¡†å¹¶å¯¼å‡º
```

### æ–¹å¼ä¸‰ï¼šç»„åˆä½¿ç”¨ï¼ˆæ¨èï¼‰â­

**é€‚ç”¨åœºæ™¯**ï¼šå¤æ‚æ–‡æ¡£ã€éœ€è¦ç²¾ç¡®æ§åˆ¶

```
1. å…ˆç”¨OCRè‡ªåŠ¨è¯†åˆ«ï¼ˆå¿«é€Ÿè¦†ç›–å¤§éƒ¨åˆ†æ–‡å­—ï¼‰
2. è¿›å…¥æ¶‚æŠ¹æ¨¡å¼è¡¥å……é—æ¼åŒºåŸŸ
3. ç”ŸæˆèƒŒæ™¯ï¼ˆOCRæ¡† + æ¶‚æŠ¹åŒºåŸŸä¼šå åŠ å¤„ç†ï¼‰
4. å¦‚æ•ˆæœä¸æ»¡æ„ï¼Œå†æ¬¡è¿›å…¥æ¶‚æŠ¹æ¨¡å¼ï¼ˆè¿­ä»£ä¿®å¤ï¼‰
5. ç¼–è¾‘å®Œæˆåå¯¼å‡º
```

---

## ğŸ¨ åŠŸèƒ½æ¼”ç¤º

### OCRè¯†åˆ« + èƒŒæ™¯ç”Ÿæˆ

```
åŸå›¾ï¼ˆAIç”Ÿæˆçš„PPTå›¾ç‰‡ï¼‰
    â†“ OCRæ£€æµ‹
è¯†åˆ«å‡ºæ–‡å­—æ¡†
    â†“ ç”ŸæˆèƒŒæ™¯
å¹²å‡€èƒŒæ™¯ + å¯ç¼–è¾‘æ–‡æœ¬æ¡†
    â†“ ç¼–è¾‘å¯¼å‡º
å¯ç¼–è¾‘çš„PPTXæ–‡ä»¶
```

### æ‰‹åŠ¨æ¶‚æŠ¹å·¥å…·

| å·¥å…· | ä½¿ç”¨æ–¹å¼ | é€‚ç”¨åœºæ™¯ |
|------|----------|----------|
| ğŸ–Œï¸ ç¬”åˆ· | æŒ‰ä½æ‹–åŠ¨æ¶‚æŠ¹ | ä¸è§„åˆ™åŒºåŸŸã€ç²¾ç»†æ“ä½œ |
| â¬œ æ¡†é€‰ | æ‹‰æ¡†é€‰æ‹©çŸ©å½¢ | è§„åˆ™æ–‡æœ¬æ¡†ã€å¿«é€Ÿæ ‡è®° |

### è¿­ä»£ä¿®å¤æµç¨‹

```
åŸå›¾ â†’ èƒŒæ™¯å›¾1ï¼ˆOCRç”Ÿæˆï¼‰
         â†“
    å‘ç°é—æ¼åŒºåŸŸ
         â†“
    è¿›å…¥æ¶‚æŠ¹æ¨¡å¼ï¼ˆè‡ªåŠ¨åŸºäºèƒŒæ™¯å›¾1ï¼‰
         â†“
    æ¶‚æŠ¹é—æ¼ â†’ ç”ŸæˆèƒŒæ™¯å›¾2ï¼ˆè¿­ä»£ä¿®å¤ï¼‰
         â†“
    ç»§ç»­ä¿®å¤ â†’ èƒŒæ™¯å›¾3...
```

### å…¨å±€æ’¤é”€/é‡åš

```
æ“ä½œå†å²ï¼š
åŸå›¾ â†’ OCRæ£€æµ‹ â†’ ç”ŸæˆèƒŒæ™¯1 â†’ æ¶‚æŠ¹æ ‡è®° â†’ ç”ŸæˆèƒŒæ™¯2

Ctrl+Z æ’¤é”€ï¼š
èƒŒæ™¯2 â†’ èƒŒæ™¯1ï¼ˆå«æ¶‚æŠ¹æ ‡è®°ï¼‰â†’ èƒŒæ™¯1ï¼ˆæ¸…ç©ºæ¶‚æŠ¹ï¼‰â†’ åŸå›¾

Ctrl+Y é‡åšï¼š
åŸå›¾ â†’ èƒŒæ™¯1 â†’ æ¶‚æŠ¹æ ‡è®° â†’ èƒŒæ™¯2
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### IOPaint APIé…ç½®

é¦–æ¬¡ä½¿ç”¨éœ€é…ç½®APIåœ°å€ï¼š

1. ç‚¹å‡»"âš™ï¸è®¾ç½®"æŒ‰é’®
2. æ‰¾åˆ°"IOPaint APIé…ç½®"
3. è¾“å…¥APIåœ°å€ï¼ˆé»˜è®¤ï¼š`http://127.0.0.1:8080/api/v1/inpaint`ï¼‰
4. ç‚¹å‡»"æµ‹è¯•è¿æ¥"éªŒè¯
5. ä¿å­˜é…ç½®

### é…ç½®æ–‡ä»¶

é…ç½®ä¿å­˜åœ¨ `ppt_editor_config.json`ï¼š

```json
{
  "model_dir": ".paddlex/official_models",
  "inpaint_api_url": "http://127.0.0.1:8080/api/v1/inpaint",
  "inpaint_enabled": true,
  "ocr_device": "cpu"
}
```

### GPUåŠ é€Ÿè®¾ç½®

å¦‚æœä½ æœ‰NVIDIAæ˜¾å¡ï¼Œå¯ä»¥å¼€å¯GPUåŠ é€Ÿï¼š

1. å®‰è£…GPUç‰ˆæœ¬PaddlePaddleï¼š
   ```bash
   pip uninstall paddlepaddle
   pip install paddlepaddle-gpu
   ```
2. æ‰“å¼€ç¨‹åºï¼Œç‚¹å‡»å³ä¸Šè§’ âš™ è®¾ç½®
3. é€‰æ‹©"GPU - é€Ÿåº¦å¿«ï¼Œéœ€è¦NVIDIAæ˜¾å¡"
4. ç‚¹å‡»"ä¿å­˜å¹¶åŠ è½½OCR"

è¯¦ç»†è¯´æ˜è§ [GPUåŠ é€Ÿä½¿ç”¨è¯´æ˜.md](GPUåŠ é€Ÿä½¿ç”¨è¯´æ˜.md)

### é«˜çº§å‚æ•°è°ƒæ•´

ä¿®æ”¹ `call_inpaint_api()` æ–¹æ³•ä¸­çš„å‚æ•°ï¼ˆçº¦ç¬¬5101è¡Œï¼‰ï¼š

- `ldm_steps`: ä¿®å¤æ­¥æ•°ï¼ˆ20-50ï¼Œé»˜è®¤30ï¼‰
- `hd_strategy`: é«˜æ¸…ç­–ç•¥ï¼ˆ"Original" / "Resize" / "Crop"ï¼‰
- `crop_padding`: è£åˆ‡è¾¹è·ï¼ˆé»˜è®¤128åƒç´ ï¼‰

---

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç”¨é€” |
|------|------|
| **PaddleOCR** | æ–‡å­—æ£€æµ‹ä¸è¯†åˆ« |
| **IOPaint** | AIå›¾åƒä¿®å¤ |
| **PIL/Pillow** | å›¾åƒå¤„ç† |
| **python-pptx** | PPTç”Ÿæˆ |
| **PyMuPDF** | PDFå¤„ç† |
| **Tkinter** | GUIç•Œé¢ |

### å·¥ä½œåŸç†

#### 1. OCRæ–‡å­—è¯†åˆ«

```python
# ä½¿ç”¨PaddleOCRæ£€æµ‹æ–‡å­—ä½ç½®
result = ocr.ocr(image, cls=True)
# æå–æ–‡å­—æ¡†åæ ‡å’Œå†…å®¹
text_boxes = [{"position": box, "text": text}]
```

#### 2. è’™ç‰ˆåˆ›å»º

```python
# åˆ›å»ºLæ¨¡å¼å›¾åƒï¼ˆé»‘ç™½è’™ç‰ˆï¼‰
mask = Image.new("L", image.size, 0)
# ç™½è‰²=éœ€è¦ä¿®å¤çš„åŒºåŸŸï¼Œé»‘è‰²=ä¿ç•™åŒºåŸŸ
draw.rectangle(box, fill=255)
```

#### 3. AIæ™ºèƒ½ä¿®å¤

```python
# æ™ºèƒ½è£åˆ‡ï¼ˆä»…å¤„ç†æœ‰è’™ç‰ˆçš„åŒºåŸŸ+paddingï¼‰
crop_region = get_mask_bounds(mask)
# Base64ç¼–ç å‘é€åˆ°IOPaint API
payload = {"image": b64_image, "mask": b64_mask}
response = requests.post(api_url, json=payload)
# é«˜æ–¯æ¨¡ç³Šè¾¹ç¼˜èåˆ
blended = Image.composite(repaired, original, blur_mask)
```

#### 4. å†å²è®°å½•ç³»ç»Ÿ

```python
history = [
    {"type": "textboxes", "data": {...}},
    {"type": "background", "data": {"old_bg_path": ..., "new_bg_path": ...}},
    {"type": "inpaint_stroke", "data": {"stroke": ..., "mask_state": ...}}
]
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
ai-ppt-restorer/
â”œâ”€â”€ modern_ppt_editor_full_enhanced.py  # ä¸»ç¨‹åºï¼ˆ5500+è¡Œï¼‰
â”œâ”€â”€ requirements.txt                     # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ README.md                            # æœ¬æ–‡æ¡£
â”œâ”€â”€ docs/                                # è¯¦ç»†æ–‡æ¡£
â”‚   â”œâ”€â”€ å…¨å±€æ’¤é”€é‡åšä½¿ç”¨è¯´æ˜.txt
â”‚   â”œâ”€â”€ è¿­ä»£ä¿®å¤ä½¿ç”¨è¯´æ˜.txt
â”‚   â”œâ”€â”€ è‡ªå®šä¹‰æ¶‚æŠ¹åŠŸèƒ½ä½¿ç”¨è¯´æ˜.txt
â”‚   â”œâ”€â”€ IOPaint_ä½¿ç”¨è¯´æ˜.md
â”‚   â”œâ”€â”€ å¿«é€Ÿå¯åŠ¨æŒ‡å—.txt
â”‚   â”œâ”€â”€ åŠŸèƒ½æ›´æ–°è¯´æ˜.txt
â”‚   â”œâ”€â”€ GPUåŠ é€Ÿä½¿ç”¨è¯´æ˜.md
â”‚   â””â”€â”€ æ¡†é€‰å¤šé€‰åŠŸèƒ½è¯´æ˜.md
â”œâ”€â”€ check_gpu.py                         # GPUç¯å¢ƒæ£€æŸ¥è„šæœ¬
â”œâ”€â”€ check_python_version.py              # Pythonç‰ˆæœ¬æ£€æŸ¥è„šæœ¬
â”œâ”€â”€ temp_backgrounds/                    # ç”Ÿæˆçš„èƒŒæ™¯å›¾ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â””â”€â”€ ppt_editor_config.json              # é…ç½®æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. AIç”ŸæˆPPTåç»­ç¼–è¾‘ â­
- Google Nano Banana Proç”Ÿæˆçš„PPTå›¾ç‰‡
- éœ€è¦ä¿®æ”¹æ–‡å­—å†…å®¹ä½†ä¸æƒ³é‡æ–°ç”Ÿæˆ
- ä¿ç•™ç²¾ç¾è®¾è®¡çš„åŒæ—¶è·å¾—ç¼–è¾‘èƒ½åŠ›

### 2. ç´ æå»æ°´å°
- å»é™¤å›¾ç‰‡ä¸­çš„æ°´å°
- å»é™¤Logoå’Œå“ç‰Œæ ‡è¯†
- æ¸…ç†ä¸å¿…è¦çš„æ–‡å­—å†…å®¹

### 3. PPTæ¨¡æ¿æå–
- ä»æˆªå›¾ä¸­æå–å¯ç¼–è¾‘çš„PPT
- å°†å›¾ç‰‡æ ¼å¼çš„æ¨¡æ¿è½¬æ¢ä¸ºPPTX
- æ‰¹é‡å¤„ç†å¤šé¡µæ–‡æ¡£

### 4. è‡ªåª’ä½“åŸåˆ›ç´ æ
- å»é™¤ç‰ˆæƒæ–‡å­—
- ç”ŸæˆåŸåˆ›å›¾ç‰‡ç´ æ
- æ‰¹é‡å¤„ç†å‡å°‘ä¾µæƒé£é™©

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| OCRè¯†åˆ«é€Ÿåº¦ | 1-3ç§’/é¡µï¼ˆCPUï¼‰ï¼Œ0.5-1ç§’/é¡µï¼ˆGPUï¼‰ |
| èƒŒæ™¯ç”Ÿæˆé€Ÿåº¦ | 5-30ç§’/é¡µï¼ˆå–å†³äºå›¾ç‰‡å¤§å°ï¼‰ |
| æ”¯æŒå›¾ç‰‡å°ºå¯¸ | æœ€å¤§4000Ã—4000åƒç´  |
| å†å²è®°å½•ä¸Šé™ | 50æ­¥ |
| æ‰¹é‡å¤„ç†èƒ½åŠ› | æ— é™åˆ¶ï¼ˆé€é¡µå¤„ç†ï¼‰ |

---

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: IOPaintè¿æ¥å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. IOPaintæœåŠ¡æ˜¯å¦å¯åŠ¨ï¼š`iopaint start --host 127.0.0.1 --port 8080`
2. ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼šæ¢ä¸€ä¸ªç«¯å£è¯•è¯•
3. é˜²ç«å¢™æ˜¯å¦æ‹¦æˆªï¼šä¸´æ—¶å…³é—­é˜²ç«å¢™æµ‹è¯•
4. APIåœ°å€æ˜¯å¦æ­£ç¡®ï¼šåœ¨è®¾ç½®ä¸­ç‚¹å‡»"æµ‹è¯•è¿æ¥"

### Q2: OCRè¯†åˆ«ä¸å‡†ç¡®ï¼Ÿ

**A**:
- ç¡®ä¿å›¾ç‰‡æ¸…æ™°ï¼Œåˆ†è¾¨ç‡è¶³å¤Ÿ
- æ–‡å­—é¢œè‰²ä¸èƒŒæ™¯å¯¹æ¯”åº¦è¦é«˜
- å¯ä»¥æ‰‹åŠ¨è¿›å…¥æ¶‚æŠ¹æ¨¡å¼è¡¥å……é—æ¼åŒºåŸŸ
- å°è¯•å¼€å¯GPUåŠ é€Ÿæé«˜è¯†åˆ«å‡†ç¡®ç‡

### Q3: ç”Ÿæˆçš„èƒŒæ™¯æœ‰ç—•è¿¹ï¼Ÿ

**A**:
- æ‰©å¤§æ¶‚æŠ¹èŒƒå›´ï¼ˆç¨å¾®è¶…å‡ºæ–‡å­—è¾¹ç¼˜5-10åƒç´ ï¼‰
- å¢åŠ  `ldm_steps` å‚æ•°åˆ°40-50ï¼ˆæé«˜ä¿®å¤è´¨é‡ï¼‰
- ä½¿ç”¨è¿­ä»£ä¿®å¤åŠŸèƒ½å¤šæ¬¡ä¼˜åŒ–
- ç¡®ä¿IOPaintä½¿ç”¨GPUæ¨¡å¼

### Q4: å¤„ç†é€Ÿåº¦å¤ªæ…¢ï¼Ÿ

**A**:
- ä½¿ç”¨GPUç‰ˆæœ¬çš„IOPaintï¼ˆé€Ÿåº¦æå‡5-10å€ï¼‰
- ç¼©å°å›¾ç‰‡å°ºå¯¸ï¼ˆå¦‚3000pxâ†’1500pxï¼‰
- ä½¿ç”¨æ¡†é€‰å·¥å…·ä»£æ›¿ç¬”åˆ·ï¼ˆå¤„ç†æ›´å¿«ï¼‰
- å‡å°‘ `ldm_steps` å‚æ•°åˆ°20-25

### Q5: åˆ‡æ¢é¡µé¢åæ¶‚æŠ¹æ¶ˆå¤±äº†ï¼Ÿ

**A**:
- æ¯é¡µçš„æ¶‚æŠ¹è’™ç‰ˆæ˜¯ç‹¬ç«‹çš„
- åˆ‡æ¢é¡µé¢å‰è¯·å…ˆç”ŸæˆèƒŒæ™¯
- ç”Ÿæˆåæ¶‚æŠ¹ä¼šè‡ªåŠ¨æ¸…ç©º
- å¯ä»¥ä½¿ç”¨å…¨å±€æ’¤é”€ï¼ˆCtrl+Zï¼‰æ¢å¤

### Q6: GPUæ¨¡å¼å¯åŠ¨æŠ¥é”™ï¼Ÿ

**A**:
- æ£€æŸ¥æ˜¯å¦å®‰è£…äº† `paddlepaddle-gpu`
- Pythonç‰ˆæœ¬æ˜¯å¦ä¸º3.8-3.12
- æ£€æŸ¥CUDAå’ŒcuDNNç‰ˆæœ¬æ˜¯å¦å…¼å®¹
- è¿è¡Œ `python check_gpu.py` è¯Šæ–­é—®é¢˜

### Q7: èƒ½å¦æ’¤é”€èƒŒæ™¯ç”Ÿæˆæ“ä½œï¼Ÿ

**A**:
- å¯ä»¥ï¼æŒ‰ `Ctrl+Z` æ’¤é”€èƒŒæ™¯ç”Ÿæˆ
- å¯ä»¥æ’¤é”€åˆ°åŸå›¾çŠ¶æ€
- æ”¯æŒé‡åšï¼ˆ`Ctrl+Y`ï¼‰
- æœ€å¤šæ”¯æŒ50æ­¥å†å²è®°å½•

### Q8: ä¸­æ–‡è·¯å¾„æ”¯æŒå—ï¼Ÿ

**A**:
- å®Œå…¨æ”¯æŒä¸­æ–‡è·¯å¾„
- æ— éœ€æ‹…å¿ƒè·¯å¾„ç¼–ç é—®é¢˜

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

### å¼€å‘ç¯å¢ƒæ­å»º

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/Tansuo2021/OCRPDF-TO-PPT.git
cd OCRPDF-TO-PPT

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements.txt
```

### æäº¤è§„èŒƒ

- åŠŸèƒ½å¼€å‘ï¼š`feat: æ·»åŠ XXXåŠŸèƒ½`
- Bugä¿®å¤ï¼š`fix: ä¿®å¤XXXé—®é¢˜`
- æ–‡æ¡£æ›´æ–°ï¼š`docs: æ›´æ–°XXXæ–‡æ¡£`
- æ€§èƒ½ä¼˜åŒ–ï¼š`perf: ä¼˜åŒ–XXXæ€§èƒ½`

---

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºåè®®ã€‚

ä½ å¯ä»¥è‡ªç”±åœ°ï¼š
- âœ… å•†ä¸šä½¿ç”¨
- âœ… ä¿®æ”¹æºä»£ç 
- âœ… åˆ†å‘å’Œå†æˆæƒ
- âœ… ç§äººä½¿ç”¨

ä½†éœ€è¦ï¼š
- ğŸ“‹ ä¿ç•™ç‰ˆæƒå£°æ˜
- ğŸ“‹ ä¿ç•™è®¸å¯è¯å£°æ˜

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [PaddleOCR](https://github.com/PaddlePaddle/PaddleOCR) - å¼ºå¤§çš„OCRè¯†åˆ«å¼•æ“
- [IOPaint](https://github.com/Sanster/IOPaint) - ä¼˜ç§€çš„AIå›¾åƒä¿®å¤å·¥å…·
- [python-pptx](https://github.com/scanny/python-pptx) - Python PPTç”Ÿæˆåº“
- [PyMuPDF](https://github.com/pymupdf/PyMuPDF) - PDFå¤„ç†å·¥å…·

---

## ğŸ“® è”ç³»æ–¹å¼

- Issue: [GitHub Issues](https://github.com/Tansuo2021/OCRPDF-TO-PPT/issues)
- Email: your.email@example.com

---

## ğŸŒŸ Star History

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ªâ­ï¸Staræ”¯æŒä¸€ä¸‹ï¼

[![Star History Chart](https://api.star-history.com/svg?repos=Tansuo2021/OCRPDF-TO-PPT&type=Date)](https://star-history.com/#Tansuo2021/OCRPDF-TO-PPT&Date)

---

<div align="center">

**Made with â¤ï¸ by Tansuo**

[â¬† å›åˆ°é¡¶éƒ¨](#ai-ppt-restorer--aiç”Ÿæˆpptå›¾ç‰‡è¿˜åŸå·¥å…·)

</div>

---

<a name="english"></a>

# English Documentation

## ğŸ“– Introduction

AI tools like Google Nano Banana Pro generate visually stunning PPT images, but they output **non-editable image formats**. When you need to modify text, you have to regenerate everything - which is extremely inconvenient.

**AI PPT Restorer** solves this problem by using **OCR + AI Inpainting** technology to convert AI-generated PPT images into fully editable PowerPoint documents.

## ğŸš€ Key Features

- âœ… **OCR Text Recognition** - Auto-detect text position and content with PaddleOCR
- âœ… **AI Background Generation** - Intelligently remove text and generate clean backgrounds via IOPaint
- âœ… **Editable Text Layers** - Restore as fully editable text boxes
- âœ… **Custom Inpainting Tools** - Brush & rectangle selection for manual marking
- âœ… **Iterative Repair** - Edit on existing backgrounds for progressive refinement
- âœ… **Global Undo/Redo** - 50-step history with Ctrl+Z/Y support
- âœ… **Multi-format Support** - Import PNG/JPG/PDF, Export PPTX/PDF
- âœ… **GPU Acceleration** - 5-10x faster with NVIDIA GPU

## ğŸ“¦ Installation

```bash
# Clone repository
git clone https://github.com/Tansuo2021/OCRPDF-TO-PPT.git
cd OCRPDF-TO-PPT

# Install dependencies
pip install -r requirements.txt

# Install and start IOPaint
pip install iopaint
iopaint start --host 127.0.0.1 --port 8080

# Run application
python modern_ppt_editor_full_enhanced.py
```

## ğŸ“š Quick Start

### Method 1: OCR Auto-Detection

1. Import image/PDF
2. Click "Detect - Current Page"
3. Click "Generate Background - Current Page"
4. Wait 5-30 seconds
5. Switch to "PPT Preview" mode
6. Edit text boxes and export

### Method 2: Manual Inpainting

1. Import image
2. Click "Enter Inpaint Mode"
3. Use brush/rectangle tools to mark regions
4. Click "Generate Background"
5. Edit and export

### Method 3: Combined Approach (Recommended) â­

1. Start with OCR auto-detect (covers most text quickly)
2. Enter inpaint mode to supplement missed areas
3. Generate background (combines OCR + manual marks)
4. Use iterative repair if needed
5. Edit and export

## ğŸ› ï¸ Tech Stack

- **PaddleOCR** - Text detection and recognition
- **IOPaint** - AI-powered image inpainting
- **PIL/Pillow** - Image processing
- **python-pptx** - PowerPoint generation
- **PyMuPDF** - PDF processing
- **Tkinter** - GUI framework
- **NumPy** - Numerical operations
- **OpenCV** - Computer vision

## ğŸ¯ Use Cases

### 1. AI-Generated PPT Editing â­
- Convert Google Nano Banana Pro output to editable format
- Modify text without regenerating entire design
- Preserve beautiful AI-generated aesthetics while gaining edit control

### 2. Watermark Removal
- Remove watermarks from images
- Clean up logos and branding
- Eliminate unwanted text overlays

### 3. PPT Template Extraction
- Extract editable PPT from screenshots
- Convert image templates to PPTX format
- Batch process multi-page documents

### 4. Content Creation
- Generate original materials for social media
- Remove copyright text from references
- Reduce infringement risk through batch processing

## ğŸ“Š Performance Metrics

| Metric | Value |
|--------|-------|
| OCR Speed | 1-3s/page (CPU), 0.5-1s/page (GPU) |
| Background Generation | 5-30s/page (depends on image size) |
| Max Image Size | 4000Ã—4000 pixels |
| History Limit | 50 steps |
| Batch Processing | Unlimited (sequential) |

## ğŸ”§ Troubleshooting

### Q: IOPaint connection failed?
**A:** Check if service is running, port is available, firewall settings, and API URL is correct

### Q: OCR accuracy issues?
**A:** Ensure clear images, high contrast, use manual inpaint mode to supplement, or enable GPU acceleration

### Q: Background artifacts?
**A:** Expand mark region by 5-10px, increase `ldm_steps` to 40-50, use iterative repair

### Q: Slow processing?
**A:** Use GPU mode, reduce image size, use rectangle tool instead of brush, decrease `ldm_steps`

### Q: Can I undo background generation?
**A:** Yes! Press `Ctrl+Z` to undo, supports up to 50 steps, can undo to original image

## ğŸ“„ License

MIT License - Free for commercial and personal use

## ğŸ™ Acknowledgments

Thanks to: **PaddleOCR**, **IOPaint**, **python-pptx**, **PyMuPDF**

---

<div align="center">

**If this project helps you, please give it a â­ï¸ Star!**

</div>
